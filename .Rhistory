library(plyr) # Data manipulation
library(tidyverse) # Data manipulation
library(mctoolsr) # Microbial analyses
library(RColorBrewer) # Colors
library(vegan) # Multivariate analyses
library(indicspecies) # Indicator species
library(car) # Stats
library(FSA) # SE
library(magrittr) # Set names
library(PMCMRplus) # Stats
library(readxl) # Excel
library(writexl) # Excel
library(plotly) # Interactive plots
library(ggmap) # Maps
library(ggsn) # Maps
library(multcomp) # Tukey HSD and significance letters
library(emmeans) # Tukey HSD and significance letters
library(scales) # View colors
library(cowplot) # Multipanels
library(qvalue) # q values for indicator species
library(reshape2) # melt
library(gridExtra) # graphs
library(grid) # graphs
library(cowplot) # graphs
library(ggpubr) # graphs
library(ggExtra) # graphs
library(ggh4x) # graphs
library(dendextend) # graphs
library(corrplot) # correlation plots
# Functions
find_hull <- function(df) df[chull(df$Axis01, df$Axis02),]
`%notin%` <- Negate(`%in%`)
paste_ranks = function(sm_taxa){
k = data.frame(k ="k_", sm_taxa['taxonomy1'])
k2 <- do.call(paste, c(k, sep = ""))
p = data.frame(k ="p_", sm_taxa['taxonomy2'])
p2 <- do.call(paste, c(p, sep = ""))
c = data.frame(k ="c_", sm_taxa['taxonomy3'])
c2 <- do.call(paste, c(c, sep = ""))
o = data.frame(k ="o_", sm_taxa['taxonomy4'])
o2 <- do.call(paste, c(o, sep = ""))
f = data.frame(k ="f_", sm_taxa['taxonomy5'])
f2 <- do.call(paste, c(f, sep = ""))
g = data.frame(k ="g_", sm_taxa['taxonomy6'])
g2 <- do.call(paste, c(g, sep = ""))
# NOT USING SPECIES HERE! OTU preprocessing doesn't!
s = data.frame(k ="s_", sm_taxa['taxonomy7'])
s2 <- do.call(paste, c(s, sep = ""))
# combine all
lineage_df = data.frame(k2, p2, c2, o2, f2, g2)
lineage = do.call(paste, c(lineage_df, sep = ';'))
return(lineage)
}
# Guild subsetting module from other repository
source("~/Documents/GitHub/SF_microbe_methane/modules/3_OTU_subsetting_modules_v.0.4_strip.r")
# Correlation functions from other repo
source("~/Documents/GitHub/EastCoast/meth_corr_by_taxonomy.R")
source("~/Documents/GitHub/EastCoast/meth_corr_by_bgc.R")
# Repository path
setwd("~/Documents/GitHub/Timberlake/")
# Wyatt Hartman's guild color palette
# Note that MeOB don't exist in this dataset, so removed
# But ANME do exist in this dataset, so add
# Extra methanogen guilds added so colors added too
Guild_cols <- read.table("~/Documents/GitHub/SF_microbe_methane/data/colors/Guild_color_palette.txt",
sep='\t') %>%
dplyr::select(Guild, G_index, color) %>%
set_names(c("Guild", "Index", "color")) %>%
mutate(Index = rev(Index)) %>%
add_row(Guild = "ANME", Index = 10, color = "#836FFF") %>%
add_row(Guild = "CH4_me", Index = 16, color = "#FDC086") %>%
add_row(Guild = "CH4_mix", Index = 17, color = "#FFFF99") %>%
filter(Guild != "MeOB") %>%
arrange(Index)
# Read in combined dataset (with other samples)
input_filt <- readRDS("input_filt_rare_comb_wBGC.rds")
# Read in combined dataset (with other samples)
input_filt <- readRDS("input_filt_comb_wBGC.rds")
# Rarefy at 26429
sort(colSums(input_filt$data_loaded))
View(input_filt$map_loaded)
# Get only Timberlake samples
input_filt_nc <- filter_data(input_filt,
filter_cat = "Estuary",
keep_vals = "Alligator")
View(input_filt_nc$map_loaded)
# Remove extra samples
input_filt_nc <- filter_data(input_filt_nc,
filter_cat = "sampleID",
filter_vals = c("TL_nw_d1_DI_ctrl_AF1",
"TL_nw_d1_DI_ctrl_AF3",
"TL_nw_d1_DI_ctrl_AF4",
"TL_nw_d1_ASW_noS_BF3",
"TL_nw_d1_ASW_noS_BF4",
"TL_nw_d1_ASW_noS_BF5",
"TL_inc_d1_SO4_5A",
"TL_inc_d1_SO4_5B",
"TL_inc_d2_SO4_5A",
"TL_inc_d2_SO4_5B"))
View(input_filt_nc$map_loaded)
names(input_filt_nc$map_loaded)
# Remove unneeded columns from metadata
input_filt_nc$map_loaded <- input_filt_nc$map_loaded %>%
dplyr::select(-Estuary, -Conductivity_uS_cm, -CH4_pw_air_ppmv, -NEE_mgC_m2_m,
-GEP_mgC_m2_m, -PAR_uE_m2_s, -CH4_pot_umol_gdw_h, -CO2_pot_umol_gdw_h,
-Fe_mgL, -Acetate_mgL, -TotalVFA_uM, -SR_umol_cm3_d, -AMG_umol_cm3_d,
-36:67)
# Read in combined dataset (with other samples)
input_filt <- readRDS("input_filt_comb_wBGC.rds")
# Get only Timberlake samples
input_filt_nc <- filter_data(input_filt,
filter_cat = "Estuary",
keep_vals = "Alligator")
# Remove extra samples
input_filt_nc <- filter_data(input_filt_nc,
filter_cat = "sampleID",
filter_vals = c("TL_nw_d1_DI_ctrl_AF1",
"TL_nw_d1_DI_ctrl_AF3",
"TL_nw_d1_DI_ctrl_AF4",
"TL_nw_d1_ASW_noS_BF3",
"TL_nw_d1_ASW_noS_BF4",
"TL_nw_d1_ASW_noS_BF5",
"TL_inc_d1_SO4_5A",
"TL_inc_d1_SO4_5B",
"TL_inc_d2_SO4_5A",
"TL_inc_d2_SO4_5B"))
ncol(input_filt_nc$map_loaded)
# Remove unneeded columns from metadata
input_filt_nc$map_loaded <- input_filt_nc$map_loaded %>%
dplyr::select(-Estuary, -Conductivity_uS_cm, -CH4_pw_air_ppmv, -NEE_mgC_m2_m,
-GEP_mgC_m2_m, -PAR_uE_m2_s, -CH4_pot_umol_gdw_h, -CO2_pot_umol_gdw_h,
-Fe_mgL, -Acetate_mgL, -TotalVFA_uM, -SR_umol_cm3_d, -AMG_umol_cm3_d,
-c(36:67))
names(input_filt_nc$map_loaded)
View(input_filt_nc$map_loaded)
View(input_filt_nc$map_loaded)
levels(input_filt_nc$map_loaded$Detail)
# Read in combined dataset (with other samples)
input_filt <- readRDS("input_filt_comb_wBGC.rds")
# Get only Timberlake samples
input_filt_nc <- filter_data(input_filt,
filter_cat = "Estuary",
keep_vals = "Alligator")
# Remove extra samples
input_filt_nc <- filter_data(input_filt_nc,
filter_cat = "sampleID",
filter_vals = c("TL_nw_d1_DI_ctrl_AF1",
"TL_nw_d1_DI_ctrl_AF3",
"TL_nw_d1_DI_ctrl_AF4",
"TL_nw_d1_ASW_noS_BF3",
"TL_nw_d1_ASW_noS_BF4",
"TL_nw_d1_ASW_noS_BF5",
"TL_inc_d1_SO4_5A",
"TL_inc_d1_SO4_5B",
"TL_inc_d2_SO4_5A",
"TL_inc_d2_SO4_5B"))
# Remove unneeded columns from metadata
input_filt_nc$map_loaded <- input_filt_nc$map_loaded %>%
dplyr::select(-Site, -Estuary, -Info, -Conductivity_uS_cm, -CH4_pw_air_ppmv, -NEE_mgC_m2_m,
-GEP_mgC_m2_m, -PAR_uE_m2_s, -CH4_pot_umol_gdw_h, -CO2_pot_umol_gdw_h,
-Fe_mgL, -Acetate_mgL, -TotalVFA_uM, -SR_umol_cm3_d, -AMG_umol_cm3_d,
-c(36:67)) %>%
rename(Treatment = Detail,
Salinity = Salinity_ppt_all) %>%
recode(Treatment, "Field Reference" = "Field", "DI_ctrl" = "Control",
"5ppt ASW" = "+ASW", "SW_noSO4" = "+ASW-SO4", "SO4 amended" = "+SO4") %>%
recode(Depth, "0.025" = "0-5 cm", "0.125" = "10-15 cm") %>%
mutate(Treatment = factor(Treatment,
levels = c("Field", "Control", "+SO4", "+ASW-SO4", "+ASW")))
# Remove unneeded columns from metadata
input_filt_nc$map_loaded <- input_filt_nc$map_loaded %>%
dplyr::select(-Site, -Estuary, -Info, -Conductivity_uS_cm, -CH4_pw_air_ppmv, -NEE_mgC_m2_m,
-GEP_mgC_m2_m, -PAR_uE_m2_s, -CH4_pot_umol_gdw_h, -CO2_pot_umol_gdw_h,
-Fe_mgL, -Acetate_mgL, -TotalVFA_uM, -SR_umol_cm3_d, -AMG_umol_cm3_d,
-c(36:67)) %>%
rename(Treatment = Detail,
Salinity = Salinity_ppt_all) %>%
recode(Treatment, "Field Reference" = "Field", "DI_ctrl" = "Control",
"5ppt ASW" = "+ASW", "SW_noSO4" = "+ASW-SO4", "SO4 amended" = "+SO4") %>%
mutate(Depth = as.factor(Depth)) %>%
recode(Depth, "0.025" = "0-5 cm", "0.125" = "10-15 cm") %>%
mutate(Treatment = factor(Treatment,
levels = c("Field", "Control", "+SO4", "+ASW-SO4", "+ASW")))
input_filt_nc$map_loaded <- input_filt_nc$map_loaded %>%
dplyr::select(-Site, -Estuary, -Info, -Conductivity_uS_cm, -CH4_pw_air_ppmv, -NEE_mgC_m2_m,
-GEP_mgC_m2_m, -PAR_uE_m2_s, -CH4_pot_umol_gdw_h, -CO2_pot_umol_gdw_h,
-Fe_mgL, -Acetate_mgL, -TotalVFA_uM, -SR_umol_cm3_d, -AMG_umol_cm3_d,
-c(36:67)) %>%
rename(Treatment = Detail,
Salinity = Salinity_ppt_all) %>%
recode(Treatment, "Field Reference" = "Field", "DI_ctrl" = "Control",
"5ppt ASW" = "+ASW", "SW_noSO4" = "+ASW-SO4", "SO4 amended" = "+SO4") %>%
mutate(Depth = as.factor(Depth))
# Remove unneeded columns from metadata
input_filt_nc$map_loaded <- input_filt_nc$map_loaded %>%
dplyr::select(-Site, -Estuary, -Info, -Conductivity_uS_cm, -CH4_pw_air_ppmv, -NEE_mgC_m2_m,
-GEP_mgC_m2_m, -PAR_uE_m2_s, -CH4_pot_umol_gdw_h, -CO2_pot_umol_gdw_h,
-Fe_mgL, -Acetate_mgL, -TotalVFA_uM, -SR_umol_cm3_d, -AMG_umol_cm3_d,
-c(36:67)) %>%
rename(Treatment = Detail,
Salinity = Salinity_ppt_all) %>%
mutate(Teatment = as.factor(Treatment)) %>%
recode(Treatment, "Field Reference" = "Field", "DI_ctrl" = "Control",
"5ppt ASW" = "+ASW", "SW_noSO4" = "+ASW-SO4", "SO4 amended" = "+SO4") %>%
mutate(Depth = as.factor(Depth)) %>%
recode(Depth, "0.025" = "0-5 cm", "0.125" = "10-15 cm") %>%
mutate(Treatment = factor(Treatment,
levels = c("Field", "Control", "+SO4", "+ASW-SO4", "+ASW")))
input_filt_nc$map_loaded <- input_filt_nc$map_loaded %>%
dplyr::select(-Site, -Estuary, -Info, -Conductivity_uS_cm, -CH4_pw_air_ppmv, -NEE_mgC_m2_m,
-GEP_mgC_m2_m, -PAR_uE_m2_s, -CH4_pot_umol_gdw_h, -CO2_pot_umol_gdw_h,
-Fe_mgL, -Acetate_mgL, -TotalVFA_uM, -SR_umol_cm3_d, -AMG_umol_cm3_d,
-c(36:67)) %>%
rename(Treatment = Detail,
Salinity = Salinity_ppt_all) %>%
mutate(Teatment = as.factor(Treatment)) %>%
recode(Treatment, "Field Reference" = "Field", "DI_ctrl" = "Control",
"5ppt ASW" = "+ASW", "SW_noSO4" = "+ASW-SO4", "SO4 amended" = "+SO4") %>%
mutate(Depth = as.factor(Depth))
# Remove unneeded columns from metadata
input_filt_nc$map_loaded <- input_filt_nc$map_loaded %>%
dplyr::select(-Site, -Estuary, -Info, -Conductivity_uS_cm, -CH4_pw_air_ppmv, -NEE_mgC_m2_m,
-GEP_mgC_m2_m, -PAR_uE_m2_s, -CH4_pot_umol_gdw_h, -CO2_pot_umol_gdw_h,
-Fe_mgL, -Acetate_mgL, -TotalVFA_uM, -SR_umol_cm3_d, -AMG_umol_cm3_d,
-c(36:67)) %>%
rename(Treatment = Detail,
Salinity = Salinity_ppt_all) %>%
mutate(Teatment = as.factor(Treatment)) %>%
recode_factor(Treatment, "Field Reference" = "Field", "DI_ctrl" = "Control",
"5ppt ASW" = "+ASW", "SW_noSO4" = "+ASW-SO4", "SO4 amended" = "+SO4") %>%
mutate(Depth = as.factor(Depth)) %>%
recode_factor(Depth, "0.025" = "0-5 cm", "0.125" = "10-15 cm") %>%
mutate(Treatment = factor(Treatment,
levels = c("Field", "Control", "+SO4", "+ASW-SO4", "+ASW")))
input_filt_nc$map_loaded <- input_filt_nc$map_loaded %>%
dplyr::select(-Site, -Estuary, -Info, -Conductivity_uS_cm, -CH4_pw_air_ppmv, -NEE_mgC_m2_m,
-GEP_mgC_m2_m, -PAR_uE_m2_s, -CH4_pot_umol_gdw_h, -CO2_pot_umol_gdw_h,
-Fe_mgL, -Acetate_mgL, -TotalVFA_uM, -SR_umol_cm3_d, -AMG_umol_cm3_d,
-c(36:67)) %>%
rename(Treatment = Detail,
Salinity = Salinity_ppt_all) %>%
mutate(Teatment = as.factor(Treatment)) %>%
recode_factor(Treatment, "Field Reference" = "Field", "DI_ctrl" = "Control",
"5ppt ASW" = "+ASW", "SW_noSO4" = "+ASW-SO4", "SO4 amended" = "+SO4")
input_filt_nc$map_loaded <- input_filt_nc$map_loaded %>%
dplyr::select(-Site, -Estuary, -Info, -Conductivity_uS_cm, -CH4_pw_air_ppmv, -NEE_mgC_m2_m,
-GEP_mgC_m2_m, -PAR_uE_m2_s, -CH4_pot_umol_gdw_h, -CO2_pot_umol_gdw_h,
-Fe_mgL, -Acetate_mgL, -TotalVFA_uM, -SR_umol_cm3_d, -AMG_umol_cm3_d,
-c(36:67)) %>%
rename(Treatment = Detail,
Salinity = Salinity_ppt_all)
View(input_filt_nc$map_loaded)
# Read in combined dataset (with other samples)
input_filt <- readRDS("input_filt_comb_wBGC.rds")
# Get only Timberlake samples
input_filt_nc <- filter_data(input_filt,
filter_cat = "Estuary",
keep_vals = "Alligator")
# Remove extra samples
input_filt_nc <- filter_data(input_filt_nc,
filter_cat = "sampleID",
filter_vals = c("TL_nw_d1_DI_ctrl_AF1",
"TL_nw_d1_DI_ctrl_AF3",
"TL_nw_d1_DI_ctrl_AF4",
"TL_nw_d1_ASW_noS_BF3",
"TL_nw_d1_ASW_noS_BF4",
"TL_nw_d1_ASW_noS_BF5",
"TL_inc_d1_SO4_5A",
"TL_inc_d1_SO4_5B",
"TL_inc_d2_SO4_5A",
"TL_inc_d2_SO4_5B"))
# Remove unneeded columns from metadata
input_filt_nc$map_loaded <- input_filt_nc$map_loaded %>%
dplyr::select(-Site, -Estuary, -Info, -Conductivity_uS_cm, -CH4_pw_air_ppmv, -NEE_mgC_m2_m,
-GEP_mgC_m2_m, -PAR_uE_m2_s, -CH4_pot_umol_gdw_h, -CO2_pot_umol_gdw_h,
-Fe_mgL, -Acetate_mgL, -TotalVFA_uM, -SR_umol_cm3_d, -AMG_umol_cm3_d,
-c(36:67)) %>%
rename(Treatment = Detail,
Salinity = Salinity_ppt_all) %>%
mutate(Treatment = as.factor(Treatment)) %>%
recode_factor(Treatment, "Field Reference" = "Field", "DI_ctrl" = "Control",
"5ppt ASW" = "+ASW", "SW_noSO4" = "+ASW-SO4", "SO4 amended" = "+SO4") %>%
mutate(Depth = as.factor(Depth)) %>%
recode_factor(Depth, "0.025" = "0-5 cm", "0.125" = "10-15 cm") %>%
mutate(Treatment = factor(Treatment,
levels = c("Field", "Control", "+SO4", "+ASW-SO4", "+ASW")))
input_filt_nc$map_loaded <- input_filt_nc$map_loaded %>%
dplyr::select(-Site, -Estuary, -Info, -Conductivity_uS_cm, -CH4_pw_air_ppmv, -NEE_mgC_m2_m,
-GEP_mgC_m2_m, -PAR_uE_m2_s, -CH4_pot_umol_gdw_h, -CO2_pot_umol_gdw_h,
-Fe_mgL, -Acetate_mgL, -TotalVFA_uM, -SR_umol_cm3_d, -AMG_umol_cm3_d,
-c(36:67)) %>%
rename(Treatment = Detail,
Salinity = Salinity_ppt_all) %>%
mutate(Treatment = as.factor(Treatment)) %>%
recode_factor(Treatment, "Field Reference" = "Field", "DI_ctrl" = "Control",
"5ppt ASW" = "+ASW", "SW_noSO4" = "+ASW-SO4", "SO4 amended" = "+SO4") %>%
mutate(Depth = as.factor(Depth))
input_filt_nc$map_loaded <- input_filt_nc$map_loaded %>%
dplyr::select(-Site, -Estuary, -Info, -Conductivity_uS_cm, -CH4_pw_air_ppmv, -NEE_mgC_m2_m,
-GEP_mgC_m2_m, -PAR_uE_m2_s, -CH4_pot_umol_gdw_h, -CO2_pot_umol_gdw_h,
-Fe_mgL, -Acetate_mgL, -TotalVFA_uM, -SR_umol_cm3_d, -AMG_umol_cm3_d,
-c(36:67)) %>%
rename(Treatment = Detail,
Salinity = Salinity_ppt_all) %>%
mutate(Treatment = as.factor(Treatment)) %>%
recode_factor(Treatment, "Field Reference" = "Field", "DI_ctrl" = "Control",
"5ppt ASW" = "+ASW", "SW_noSO4" = "+ASW-SO4", "SO4 amended" = "+SO4")
input_filt_nc$map_loaded <- input_filt_nc$map_loaded %>%
dplyr::select(-Site, -Estuary, -Info, -Conductivity_uS_cm, -CH4_pw_air_ppmv, -NEE_mgC_m2_m,
-GEP_mgC_m2_m, -PAR_uE_m2_s, -CH4_pot_umol_gdw_h, -CO2_pot_umol_gdw_h,
-Fe_mgL, -Acetate_mgL, -TotalVFA_uM, -SR_umol_cm3_d, -AMG_umol_cm3_d,
-c(36:67)) %>%
rename(Treatment = Detail,
Salinity = Salinity_ppt_all) %>%
mutate(Treatment = as.factor(Treatment))
# Read in combined dataset (with other samples)
input_filt <- readRDS("input_filt_comb_wBGC.rds")
# Get only Timberlake samples
input_filt_nc <- filter_data(input_filt,
filter_cat = "Estuary",
keep_vals = "Alligator")
# Remove extra samples
input_filt_nc <- filter_data(input_filt_nc,
filter_cat = "sampleID",
filter_vals = c("TL_nw_d1_DI_ctrl_AF1",
"TL_nw_d1_DI_ctrl_AF3",
"TL_nw_d1_DI_ctrl_AF4",
"TL_nw_d1_ASW_noS_BF3",
"TL_nw_d1_ASW_noS_BF4",
"TL_nw_d1_ASW_noS_BF5",
"TL_inc_d1_SO4_5A",
"TL_inc_d1_SO4_5B",
"TL_inc_d2_SO4_5A",
"TL_inc_d2_SO4_5B"))
# Remove unneeded columns from metadata
input_filt_nc$map_loaded <- input_filt_nc$map_loaded %>%
dplyr::select(-Site, -Estuary, -Info, -Conductivity_uS_cm, -CH4_pw_air_ppmv, -NEE_mgC_m2_m,
-GEP_mgC_m2_m, -PAR_uE_m2_s, -CH4_pot_umol_gdw_h, -CO2_pot_umol_gdw_h,
-Fe_mgL, -Acetate_mgL, -TotalVFA_uM, -SR_umol_cm3_d, -AMG_umol_cm3_d,
-c(36:67)) %>%
rename(Treatment = Detail,
Salinity = Salinity_ppt_all) %>%
mutate(Treatment = as.factor(Treatment)) %>%
recode_factor(`Treatment`, "Field Reference" = "Field", "DI_ctrl" = "Control",
"5ppt ASW" = "+ASW", "SW_noSO4" = "+ASW-SO4", "SO4 amended" = "+SO4") %>%
mutate(Depth = as.factor(Depth)) %>%
recode_factor(`Depth`, "0.025" = "0-5 cm", "0.125" = "10-15 cm") %>%
mutate(Treatment = factor(Treatment,
levels = c("Field", "Control", "+SO4", "+ASW-SO4", "+ASW")))
# Remove unneeded columns from metadata
input_filt_nc$map_loaded <- input_filt_nc$map_loaded %>%
dplyr::select(-Site, -Estuary, -Info, -Conductivity_uS_cm, -CH4_pw_air_ppmv, -NEE_mgC_m2_m,
-GEP_mgC_m2_m, -PAR_uE_m2_s, -CH4_pot_umol_gdw_h, -CO2_pot_umol_gdw_h,
-Fe_mgL, -Acetate_mgL, -TotalVFA_uM, -SR_umol_cm3_d, -AMG_umol_cm3_d,
-c(36:67)) %>%
rename(Treatment = Detail,
Salinity = Salinity_ppt_all) %>%
mutate(Treatment = as.factor(Treatment)) %>%
dplyr::recode_factor(`Treatment`, "Field Reference" = "Field", "DI_ctrl" = "Control",
"5ppt ASW" = "+ASW", "SW_noSO4" = "+ASW-SO4", "SO4 amended" = "+SO4") %>%
mutate(Depth = as.factor(Depth)) %>%
dplyr::recode_factor(`Depth`, "0.025" = "0-5 cm", "0.125" = "10-15 cm") %>%
mutate(Treatment = factor(Treatment,
levels = c("Field", "Control", "+SO4", "+ASW-SO4", "+ASW")))
input_filt_nc$map_loaded <- input_filt_nc$map_loaded %>%
dplyr::select(-Site, -Estuary, -Info, -Conductivity_uS_cm, -CH4_pw_air_ppmv, -NEE_mgC_m2_m,
-GEP_mgC_m2_m, -PAR_uE_m2_s, -CH4_pot_umol_gdw_h, -CO2_pot_umol_gdw_h,
-Fe_mgL, -Acetate_mgL, -TotalVFA_uM, -SR_umol_cm3_d, -AMG_umol_cm3_d,
-c(36:67)) %>%
rename(Treatment = Detail,
Salinity = Salinity_ppt_all) %>%
mutate(Treatment = as.factor(Treatment))
levels(input_filt_nc$map_loaded$Treatment)
input_filt_nc$map_loaded$Treatment <- dplyr::recode_factor(`Treatment`, "Field Reference" = "Field", "DI_ctrl" = "Control",
"5ppt ASW" = "+ASW", "SW_noSO4" = "+ASW-SO4", "SO4 amended" = "+SO4")
input_filt_nc$map_loaded$Treatment <- dplyr::recode_factor(input_filt_nc$map_loaded$Treatment,
"Field Reference" = "Field", "DI_ctrl" = "Control",
"5ppt ASW" = "+ASW", "SW_noSO4" = "+ASW-SO4", "SO4 amended" = "+SO4")
# Read in combined dataset (with other samples)
input_filt <- readRDS("input_filt_comb_wBGC.rds")
# Get only Timberlake samples
input_filt_nc <- filter_data(input_filt,
filter_cat = "Estuary",
keep_vals = "Alligator")
# Remove extra samples
input_filt_nc <- filter_data(input_filt_nc,
filter_cat = "sampleID",
filter_vals = c("TL_nw_d1_DI_ctrl_AF1",
"TL_nw_d1_DI_ctrl_AF3",
"TL_nw_d1_DI_ctrl_AF4",
"TL_nw_d1_ASW_noS_BF3",
"TL_nw_d1_ASW_noS_BF4",
"TL_nw_d1_ASW_noS_BF5",
"TL_inc_d1_SO4_5A",
"TL_inc_d1_SO4_5B",
"TL_inc_d2_SO4_5A",
"TL_inc_d2_SO4_5B"))
# Remove unneeded columns from metadata
input_filt_nc$map_loaded <- input_filt_nc$map_loaded %>%
dplyr::select(-Site, -Estuary, -Info, -Conductivity_uS_cm, -CH4_pw_air_ppmv, -NEE_mgC_m2_m,
-GEP_mgC_m2_m, -PAR_uE_m2_s, -CH4_pot_umol_gdw_h, -CO2_pot_umol_gdw_h,
-Fe_mgL, -Acetate_mgL, -TotalVFA_uM, -SR_umol_cm3_d, -AMG_umol_cm3_d,
-c(36:67)) %>%
rename(Treatment = Detail,
Salinity = Salinity_ppt_all) %>%
mutate(Treatment = as.factor(Treatment)) %>%
fct_recode(Treatment, "Field Reference" = "Field", "DI_ctrl" = "Control",
"5ppt ASW" = "+ASW", "SW_noSO4" = "+ASW-SO4", "SO4 amended" = "+SO4") %>%
mutate(Depth = as.factor(Depth)) %>%
fct_recode(Depth, "0.025" = "0-5 cm", "0.125" = "10-15 cm") %>%
mutate(Treatment = factor(Treatment,
levels = c("Field", "Control", "+SO4", "+ASW-SO4", "+ASW")))
# Remove unneeded columns from metadata
input_filt_nc$map_loaded <- input_filt_nc$map_loaded %>%
dplyr::select(-Site, -Estuary, -Info, -Conductivity_uS_cm, -CH4_pw_air_ppmv, -NEE_mgC_m2_m,
-GEP_mgC_m2_m, -PAR_uE_m2_s, -CH4_pot_umol_gdw_h, -CO2_pot_umol_gdw_h,
-Fe_mgL, -Acetate_mgL, -TotalVFA_uM, -SR_umol_cm3_d, -AMG_umol_cm3_d,
-c(36:67)) %>%
rename(Treatment = Detail,
Salinity = Salinity_ppt_all) %>%
mutate(Treatment = as.factor(Treatment)) %>%
fct_recode("Treatment", "Field Reference" = "Field", "DI_ctrl" = "Control",
"5ppt ASW" = "+ASW", "SW_noSO4" = "+ASW-SO4", "SO4 amended" = "+SO4") %>%
mutate(Depth = as.factor(Depth)) %>%
fct_recode("Depth", "0.025" = "0-5 cm", "0.125" = "10-15 cm") %>%
mutate(Treatment = factor(Treatment,
levels = c("Field", "Control", "+SO4", "+ASW-SO4", "+ASW")))
# Remove unneeded columns from metadata
input_filt_nc$map_loaded <- input_filt_nc$map_loaded %>%
dplyr::select(-Site, -Estuary, -Info, -Conductivity_uS_cm, -CH4_pw_air_ppmv, -NEE_mgC_m2_m,
-GEP_mgC_m2_m, -PAR_uE_m2_s, -CH4_pot_umol_gdw_h, -CO2_pot_umol_gdw_h,
-Fe_mgL, -Acetate_mgL, -TotalVFA_uM, -SR_umol_cm3_d, -AMG_umol_cm3_d,
-c(36:67)) %>%
rename(Treatment = Detail,
Salinity = Salinity_ppt_all) %>%
mutate(.$Treatment = as.factor(Treatment)) %>%
# Remove unneeded columns from metadata
input_filt_nc$map_loaded <- input_filt_nc$map_loaded %>%
dplyr::select(-Site, -Estuary, -Info, -Conductivity_uS_cm, -CH4_pw_air_ppmv, -NEE_mgC_m2_m,
-GEP_mgC_m2_m, -PAR_uE_m2_s, -CH4_pot_umol_gdw_h, -CO2_pot_umol_gdw_h,
-Fe_mgL, -Acetate_mgL, -TotalVFA_uM, -SR_umol_cm3_d, -AMG_umol_cm3_d,
-c(36:67)) %>%
rename(Treatment = Detail,
Salinity = Salinity_ppt_all) %>%
mutate(Treatment = as.factor(Treatment)) %>%
fct_recode(.$Treatment, "Field Reference" = "Field", "DI_ctrl" = "Control",
"5ppt ASW" = "+ASW", "SW_noSO4" = "+ASW-SO4", "SO4 amended" = "+SO4") %>%
mutate(Depth = as.factor(Depth)) %>%
fct_recode(.$Depth, "0.025" = "0-5 cm", "0.125" = "10-15 cm") %>%
mutate(Treatment = factor(Treatment,
levels = c("Field", "Control", "+SO4", "+ASW-SO4", "+ASW")))
# Remove unneeded columns from metadata
input_filt_nc$map_loaded <- input_filt_nc$map_loaded %>%
dplyr::select(-Site, -Estuary, -Info, -Conductivity_uS_cm, -CH4_pw_air_ppmv, -NEE_mgC_m2_m,
-GEP_mgC_m2_m, -PAR_uE_m2_s, -CH4_pot_umol_gdw_h, -CO2_pot_umol_gdw_h,
-Fe_mgL, -Acetate_mgL, -TotalVFA_uM, -SR_umol_cm3_d, -AMG_umol_cm3_d,
-c(36:67)) %>%
rename(Treatment = Detail,
Salinity = Salinity_ppt_all) %>%
mutate(Treatment = as.factor(Treatment)) %>%
fct_recode(.[[1]], "Field Reference" = "Field", "DI_ctrl" = "Control",
"5ppt ASW" = "+ASW", "SW_noSO4" = "+ASW-SO4", "SO4 amended" = "+SO4") %>%
mutate(Depth = as.factor(Depth)) %>%
fct_recode(.[[2]], "0.025" = "0-5 cm", "0.125" = "10-15 cm") %>%
mutate(Treatment = factor(Treatment,
levels = c("Field", "Control", "+SO4", "+ASW-SO4", "+ASW")))
View(input_filt_nc$map_loaded)
