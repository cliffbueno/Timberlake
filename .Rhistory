rep("ASW", 5)))
ann_rows <- data.frame(row.names = rownames(mko_metD_mat),
Pathway = mko_metD_meta$Pathway_Specific,
Process = mko_metD_meta$Pathway_General)
View(ann_rows)
ann_colors <- list(Pathway = c(Trimethylamine = brewer.pal(7, "Purples")[1],
Dimethylamine = brewer.pal(7, "Purples")[2],
Methylamine = brewer.pal(7, "Purples")[3],
Methylamines = brewer.pal(7, "Purples")[4],
Methanol = brewer.pal(7, "Purples")[5],
Betaine = brewer.pal(7, "Purples")[6],
`DMS/MeSH/MMPA` = brewer.pal(7, "Purples")[7],
`Wood-Ljungdahl - CO2 out` = "orange",
`Na out` = "purple",
"Methyl-CoM reduction" = "#21908CFF",
Methanophenazine = brewer.pal(9, "YlOrRd")[1],
Ferredoxin = brewer.pal(9, "YlOrRd")[2],
Hydrogenase = brewer.pal(9, "YlOrRd")[3]),
Process = c("Methyl-CoM formation" = "#440154FF",
"Methanogenesis" = "#21908CFF",
"CoB - CoM regeneration" = "#FDE725FF"),
Treatment = c(Control = "#3B528BFF",
SO4 = "#21908CFF",
`ASW-SO4` = "#5DC863FF",
ASW = "#FDE725FF"))
pheatmap(mko_metD_mat,
legend = T,
legend_breaks = c(-3, -2, -1, 0, 1, 2, 3, max(mko_ace_mat, na.rm = T)),
legend_labels = c("-3","-2","-1","0","1","2","3","Abund.\n"),
main = "Hydrogenotrophic Methanogenesis",
border_color = NA,
scale = "none",
angle_col = 315,
fontsize = 8,
annotation_col = ann_cols,
annotation_row = ann_rows,
annotation_colors = ann_colors,
cluster_rows = F,
cluster_cols = F,
gaps_col = c(5, 10, 13),
filename = "InitialFigs/KO_heatmap_methylDis.png",
width = 7,
height = 7)
ann_colors <- list(Pathway = c(Trimethylamine = brewer.pal(7, "Purples")[1],
Dimethylamine = brewer.pal(7, "Purples")[2],
Methylamine = brewer.pal(7, "Purples")[3],
Methylamines = brewer.pal(7, "Purples")[4],
Methanol = brewer.pal(7, "Purples")[5],
Betaine = brewer.pal(7, "Purples")[6],
`DMS/MeSH/MMPA` = brewer.pal(7, "Purples")[7],
`Wood-Ljungdahl - CO2 out` = "orange",
`Na in` = "purple",
"Methyl-CoM reduction" = "#21908CFF",
Methanophenazine = brewer.pal(9, "YlOrRd")[1],
Ferredoxin = brewer.pal(9, "YlOrRd")[2],
Hydrogenase = brewer.pal(9, "YlOrRd")[3]),
Process = c("Methyl-CoM formation" = "#440154FF",
"Methanogenesis" = "#21908CFF",
"CoB - CoM regeneration" = "#FDE725FF"),
Treatment = c(Control = "#3B528BFF",
SO4 = "#21908CFF",
`ASW-SO4` = "#5DC863FF",
ASW = "#FDE725FF"))
pheatmap(mko_metD_mat,
legend = T,
legend_breaks = c(-3, -2, -1, 0, 1, 2, 3, max(mko_ace_mat, na.rm = T)),
legend_labels = c("-3","-2","-1","0","1","2","3","Abund.\n"),
main = "Hydrogenotrophic Methanogenesis",
border_color = NA,
scale = "none",
angle_col = 315,
fontsize = 8,
annotation_col = ann_cols,
annotation_row = ann_rows,
annotation_colors = ann_colors,
cluster_rows = F,
cluster_cols = F,
gaps_col = c(5, 10, 13),
filename = "InitialFigs/KO_heatmap_methylDis.png",
width = 7,
height = 7)
dev.off()
dev.set(dev.next())
dev.set(dev.next())
# Methyl dismutation
ann_cols <- data.frame(row.names = colnames(mko_metR_mat),
"Treatment" = c(rep("Control", 5),
rep("SO4", 5),
rep("ASW-SO4", 3),
rep("ASW", 5)))
ann_rows <- data.frame(row.names = rownames(mko_metR_mat),
Pathway = mko_metR_meta$Pathway_Specific,
Process = mko_metR_meta$Pathway_General,
`M. blatticola` = mko_metR_meta$`M. blatticola`,
`M. stadtmanae` = mko_metR_meta$`M. stadtmanae`,
`M. luminyensis` = mko_metR_meta$`M. luminyensis`,
`M. thermophilum` = mko_metR_meta$`M. thermophilum`)
ann_colors <- list(Pathway = c(Trimethylamine = brewer.pal(7, "Purples")[1],
Dimethylamine = brewer.pal(7, "Purples")[2],
Methylamine = brewer.pal(7, "Purples")[3],
Methylamines = brewer.pal(7, "Purples")[4],
Methanol = brewer.pal(7, "Purples")[5],
Betaine = brewer.pal(7, "Purples")[6],
`DMS/MeSH/MMPA` = brewer.pal(7, "Purples")[7],
`Wood-Ljungdahl - CO2 out` = "orange",
`Na in` = "purple",
"Methyl-CoM reduction" = "#21908CFF",
Methanophenazine = brewer.pal(9, "YlOrRd")[1],
Ferredoxin = brewer.pal(9, "YlOrRd")[2],
Hydrogenase = brewer.pal(9, "YlOrRd")[3]),
Process = c("Methyl-CoM formation" = "#440154FF",
"Methanogenesis" = "#21908CFF",
"CoB - CoM regeneration" = "#FDE725FF"),
`M. blatticola` = c("Present" = "black",
"Absent" = "white"),
`M. stadtmanae` = c("Present" = "black",
"Absent" = "white"),
`M. luminyensis` = c("Present" = "black",
"Absent" = "white"),
`M. thermophilum` = c("Present" = "black",
"Absent" = "white"),
Treatment = c(Control = "#3B528BFF",
SO4 = "#21908CFF",
`ASW-SO4` = "#5DC863FF",
ASW = "#FDE725FF"))
pheatmap(mko_metR_mat,
legend = T,
legend_breaks = c(-3, -2, -1, 0, 1, 2, 3, max(mko_ace_mat, na.rm = T)),
legend_labels = c("-3","-2","-1","0","1","2","3","Abund.\n"),
main = "Hydrogenotrophic Methanogenesis",
border_color = NA,
scale = "none",
angle_col = 315,
fontsize = 8,
annotation_col = ann_cols,
annotation_row = ann_rows,
annotation_colors = ann_colors,
cluster_rows = F,
cluster_cols = F,
gaps_col = c(5, 10, 13),
filename = "InitialFigs/KO_heatmap_methylDis.png",
width = 7,
height = 7)
ann_colors <- list(Pathway = c(Trimethylamine = brewer.pal(7, "Purples")[1],
Dimethylamine = brewer.pal(7, "Purples")[2],
Methylamine = brewer.pal(7, "Purples")[3],
Methylamines = brewer.pal(7, "Purples")[4],
Methanol = brewer.pal(7, "Purples")[5],
Betaine = brewer.pal(7, "Purples")[6],
`DMS/MeSH/MMPA` = brewer.pal(7, "Purples")[7],
`Wood-Ljungdahl - CO2 out` = "orange",
`Na in` = "purple",
"Methyl-CoM reduction" = "#21908CFF",
Methanophenazine = brewer.pal(9, "YlOrRd")[1],
Ferredoxin = brewer.pal(9, "YlOrRd")[2],
Hydrogenase = brewer.pal(9, "YlOrRd")[3]),
Process = c("Methyl-CoM formation" = "#440154FF",
"Methanogenesis" = "#21908CFF",
"CoB - CoM regeneration" = "#FDE725FF"),
`M_blatticola` = c("Present" = "black",
"Absent" = "white"),
`M_stadtmanae` = c("Present" = "black",
"Absent" = "white"),
`M_luminyensis` = c("Present" = "black",
"Absent" = "white"),
`M_thermophilum` = c("Present" = "black",
"Absent" = "white"),
Treatment = c(Control = "#3B528BFF",
SO4 = "#21908CFF",
`ASW-SO4` = "#5DC863FF",
ASW = "#FDE725FF"))
pheatmap(mko_metR_mat,
legend = T,
legend_breaks = c(-3, -2, -1, 0, 1, 2, 3, max(mko_ace_mat, na.rm = T)),
legend_labels = c("-3","-2","-1","0","1","2","3","Abund.\n"),
main = "Hydrogenotrophic Methanogenesis",
border_color = NA,
scale = "none",
angle_col = 315,
fontsize = 8,
annotation_col = ann_cols,
annotation_row = ann_rows,
annotation_colors = ann_colors,
cluster_rows = F,
cluster_cols = F,
gaps_col = c(5, 10, 13),
filename = "InitialFigs/KO_heatmap_methylDis.png",
width = 7,
height = 7)
ann_colors <- list(Pathway = c(Trimethylamine = brewer.pal(7, "Purples")[1],
Dimethylamine = brewer.pal(7, "Purples")[2],
Methylamine = brewer.pal(7, "Purples")[3],
Methylamines = brewer.pal(7, "Purples")[4],
Methanol = brewer.pal(7, "Purples")[5],
Betaine = brewer.pal(7, "Purples")[6],
`DMS/MeSH/MMPA` = brewer.pal(7, "Purples")[7],
`Wood-Ljungdahl - CO2 out` = "orange",
`Na in` = "purple",
"Methyl-CoM reduction" = "#21908CFF",
Methanophenazine = brewer.pal(9, "YlOrRd")[1],
Ferredoxin = brewer.pal(9, "YlOrRd")[2],
Hydrogenase = brewer.pal(9, "YlOrRd")[3],
Formate = brewer.pal(9, "YlOrRd")[4]),
Process = c("Methyl-CoM formation" = "#440154FF",
"Methanogenesis" = "#21908CFF",
"CoB - CoM regeneration" = "#FDE725FF"),
`M_blatticola` = c("Present" = "black",
"Absent" = "white"),
`M_stadtmanae` = c("Present" = "black",
"Absent" = "white"),
`M_luminyensis` = c("Present" = "black",
"Absent" = "white"),
`M_thermophilum` = c("Present" = "black",
"Absent" = "white"),
Treatment = c(Control = "#3B528BFF",
SO4 = "#21908CFF",
`ASW-SO4` = "#5DC863FF",
ASW = "#FDE725FF"))
pheatmap(mko_metR_mat,
legend = T,
legend_breaks = c(-3, -2, -1, 0, 1, 2, 3, max(mko_ace_mat, na.rm = T)),
legend_labels = c("-3","-2","-1","0","1","2","3","Abund.\n"),
main = "Hydrogenotrophic Methanogenesis",
border_color = NA,
scale = "none",
angle_col = 315,
fontsize = 8,
annotation_col = ann_cols,
annotation_row = ann_rows,
annotation_colors = ann_colors,
cluster_rows = F,
cluster_cols = F,
gaps_col = c(5, 10, 13),
filename = "InitialFigs/KO_heatmap_methylDis.png",
width = 7,
height = 7)
dev.off()
dev.set(dev.next())
dev.set(dev.next())
pheatmap(mko_metR_mat,
legend = T,
legend_breaks = c(-3, -2, -1, 0, 1, 2, 3, max(mko_ace_mat, na.rm = T)),
legend_labels = c("-3","-2","-1","0","1","2","3","Abund.\n"),
main = "Hydrogenotrophic Methanogenesis",
border_color = NA,
scale = "none",
angle_col = 315,
fontsize = 8,
annotation_col = ann_cols,
annotation_row = ann_rows,
annotation_colors = ann_colors,
cluster_rows = F,
cluster_cols = F,
gaps_col = c(5, 10, 13),
filename = "InitialFigs/KO_heatmap_methylRed.png",
width = 7,
height = 7)
dev.off()
dev.set(dev.next())
dev.set(dev.next())
# Methyl dismutation
ann_cols <- data.frame(row.names = colnames(mko_metR_mat),
"Treatment" = c(rep("Control", 5),
rep("SO4", 5),
rep("ASW-SO4", 3),
rep("ASW", 5)))
ann_rows <- data.frame(row.names = rownames(mko_metR_mat),
Pathway = mko_metR_meta$Pathway_Specific,
Process = mko_metR_meta$Pathway_General,
`M_blatticola` = mko_metR_meta$`M. blatticola`,
`M_stadtmanae` = mko_metR_meta$`M. stadtmanae`,
`M_luminyensis` = mko_metR_meta$`M. luminyensis`,
`M_thermophilum` = mko_metR_meta$`M. thermophilum`)
ann_colors <- list(Pathway = c(Trimethylamine = brewer.pal(7, "Purples")[1],
Dimethylamine = brewer.pal(7, "Purples")[2],
Methylamine = brewer.pal(7, "Purples")[3],
Methylamines = brewer.pal(7, "Purples")[4],
Methanol = brewer.pal(7, "Purples")[5],
Betaine = brewer.pal(7, "Purples")[6],
`DMS/MeSH/MMPA` = brewer.pal(7, "Purples")[7],
`Wood-Ljungdahl - CO2 out` = "orange",
`Na in` = "purple",
"Methyl-CoM reduction" = "#21908CFF",
Methanophenazine = brewer.pal(9, "YlOrRd")[1],
Ferredoxin = brewer.pal(9, "YlOrRd")[2],
Hydrogenase = brewer.pal(9, "YlOrRd")[3],
Formate = brewer.pal(9, "YlOrRd")[4]),
Process = c("Methyl-CoM formation" = "#440154FF",
"Methanogenesis" = "#21908CFF",
"CoB - CoM regeneration" = "#FDE725FF"),
`M_blatticola` = c("Present" = "black",
"Absent" = "white"),
`M_stadtmanae` = c("Present" = "black",
"Absent" = "white"),
`M_luminyensis` = c("Present" = "black",
"Absent" = "white"),
`M_thermophilum` = c("Present" = "black",
"Absent" = "white"),
Treatment = c(Control = "#3B528BFF",
SO4 = "#21908CFF",
`ASW-SO4` = "#5DC863FF",
ASW = "#FDE725FF"))
pheatmap(mko_metR_mat,
legend = T,
legend_breaks = c(-3, -2, -1, 0, 1, 2, 3, max(mko_ace_mat, na.rm = T)),
legend_labels = c("-3","-2","-1","0","1","2","3","Abund.\n"),
main = "Hydrogenotrophic Methanogenesis",
border_color = NA,
scale = "none",
angle_col = 315,
fontsize = 8,
annotation_col = ann_cols,
annotation_row = ann_rows,
annotation_colors = ann_colors,
cluster_rows = F,
cluster_cols = F,
gaps_col = c(5, 10, 13),
filename = "InitialFigs/KO_heatmap_methylRed.png",
width = 7,
height = 7)
dev.off()
dev.set(dev.next())
dev.set(dev.next())
# Methyl dismutation
ann_cols <- data.frame(row.names = colnames(mko_metD_mat),
"Treatment" = c(rep("Control", 5),
rep("SO4", 5),
rep("ASW-SO4", 3),
rep("ASW", 5)))
ann_rows <- data.frame(row.names = rownames(mko_metD_mat),
Pathway = mko_metD_meta$Pathway_Specific,
Process = mko_metD_meta$Pathway_General)
ann_colors <- list(Pathway = c(Trimethylamine = brewer.pal(7, "Purples")[1],
Dimethylamine = brewer.pal(7, "Purples")[2],
Methylamine = brewer.pal(7, "Purples")[3],
Methylamines = brewer.pal(7, "Purples")[4],
Methanol = brewer.pal(7, "Purples")[5],
Betaine = brewer.pal(7, "Purples")[6],
`DMS/MeSH/MMPA` = brewer.pal(7, "Purples")[7],
`Wood-Ljungdahl - CO2 out` = "orange",
`Na in` = "purple",
"Methyl-CoM reduction" = "#21908CFF",
Methanophenazine = brewer.pal(9, "YlOrRd")[1],
Ferredoxin = brewer.pal(9, "YlOrRd")[2],
Hydrogenase = brewer.pal(9, "YlOrRd")[3]),
Process = c("Methyl-CoM formation" = "#440154FF",
"Methanogenesis" = "#21908CFF",
"CoB - CoM regeneration" = "#FDE725FF"),
Treatment = c(Control = "#3B528BFF",
SO4 = "#21908CFF",
`ASW-SO4` = "#5DC863FF",
ASW = "#FDE725FF"))
pheatmap(mko_metD_mat,
legend = T,
legend_breaks = c(-3, -2, -1, 0, 1, 2, 3, max(mko_ace_mat, na.rm = T)),
legend_labels = c("-3","-2","-1","0","1","2","3","Abund.\n"),
main = "Hydrogenotrophic Methanogenesis",
border_color = NA,
scale = "none",
angle_col = 315,
fontsize = 8,
annotation_col = ann_cols,
annotation_row = ann_rows,
annotation_colors = ann_colors,
cluster_rows = F,
cluster_cols = F,
gaps_col = c(5, 10, 13),
filename = "InitialFigs/KO_heatmap_methylDis.png",
width = 7,
height = 7)
dev.off()
dev.set(dev.next())
dev.set(dev.next())
View(KO_Resp_HeatDStt)
names(KO_Resp_HeatDStt)[6:10] <- c("SO4_2", "SO4_3", "SO4_4", "SO4_5A", "SO4_5B")
ann_cols <- data.frame(row.names = colnames(KO_Resp_HeatDStt),
"Treatment" = c(rep("Control", 5),
rep("SO4", 5),
rep("ASW-SO4", 3),
rep("ASW", 5)))
ann_rows <- data.frame(row.names = rownames(KO_Resp_HeatDStt),
"CH4_cor" = cor_table$CH4_cor,
"L2" = KO_Resp_HeatDS0$L2,
"L1" = KO_Resp_HeatDS0$L1)
ann_colors <- list(Treatment = c(Control = "#3B528BFF",
SO4 = "#21908CFF",
`ASW-SO4` = "#5DC863FF",
ASW = "#FDE725FF"),
CH4_cor = c(Positive = "red", Negative = "blue", None = "grey95"),
L1 = c(`Carbon ` = "brown",
Nitrogen = "forestgreen",
Phosphorus = "deepskyblue3",
Sulfur = "magenta",
CH4_cycling = "grey40",
Fermentation = "darkorange"),
L2 = c(Sugars = L2_cols$color[22],
Polymers = L2_cols$color[18],
Aromatic = L2_cols$color[1],
NO3_reduction = L2_cols$color[14],
NH3_oxidation = L2_cols$color[11],
`NO3_A.reduction` = L2_cols$color[13],
NH4_assimilation = L2_cols$color[12],
N2_fixation = L2_cols$color[10],
P_regulation = L2_cols$color[15],
`PolyP-ases ` = L2_cols$color[17],
Phn_transport = L2_cols$color[16],
`CH3-phosphonate` = L2_cols$color[2],
S2O3_oxidation = L2_cols$color[19],
SO4_A.reduction = L2_cols$color[20],
SO4_D.reduction = L2_cols$color[21],
CH4_oxidation = L2_cols$color[7],
CH4_H2_reduction = L2_cols$color[4],
CH4_acetate = L2_cols$color[5],
CH4_methylotroph = L2_cols$color[6],
CH4_Archaeal = L2_cols$color[3],
H2_production = L2_cols$color[9],
Fermentation = L2_cols$color[8]))
names(KO_Resp_HeatDStt)[6:10] <- c("SO4_2", "SO4_3", "SO4_4", "SO4_5A", "SO4_5B")
pheatmap(KO_Resp_HeatDStt,
legend = T,
legend_breaks = c(-2, -1, 0, 1, 2, max(KO_Resp_HeatDStt)),
legend_labels = c("-2","-1","0","1","2","Abund.\n"),
main = "",
border_color = NA,
scale = "none",
angle_col = 315,
fontsize = 8,
annotation_col = ann_cols,
annotation_row = ann_rows,
annotation_colors = ann_colors,
cluster_rows = F,
cluster_cols = F,
gaps_row = c(12, 19, 25, 31, 50),
gaps_col = c(5, 10, 13),
filename = "InitialFigs/KO_heatmap.png",
width = 7,
height = 7)
dev.off()
dev.set(dev.next())
dev.set(dev.next())
pheatmap(KO_Resp_HeatDStt,
legend = T,
legend_breaks = c(-2, -1, 0, 1, 2, max(KO_Resp_HeatDStt)),
legend_labels = c("-2","-1","0","1","2","Abund.\n"),
main = "",
border_color = NA,
scale = "none",
angle_col = 315,
fontsize = 8,
annotation_col = ann_cols,
annotation_row = ann_rows,
annotation_colors = ann_colors,
cluster_rows = F,
cluster_cols = F,
gaps_row = c(12, 19, 25, 31, 50),
gaps_col = c(5, 10, 13),
#filename = "InitialFigs/KO_heatmap.png",
filename = "FinalFigs/Figure3.png",
width = 7,
height = 7)
dev.off()
dev.set(dev.next())
dev.set(dev.next())
names(KO_Resp_HeatDStt)
View(KO_Resp_HeatDStt)
colnames(KO_Resp_HeatDStt)[6:10] <- c("SO4_2", "SO4_3", "SO4_4", "SO4_5A", "SO4_5B")
pheatmap(KO_Resp_HeatDStt,
legend = T,
legend_breaks = c(-2, -1, 0, 1, 2, max(KO_Resp_HeatDStt)),
legend_labels = c("-2","-1","0","1","2","Abund.\n"),
main = "",
border_color = NA,
scale = "none",
angle_col = 315,
fontsize = 8,
annotation_col = ann_cols,
annotation_row = ann_rows,
annotation_colors = ann_colors,
cluster_rows = F,
cluster_cols = F,
gaps_row = c(12, 19, 25, 31, 50),
gaps_col = c(5, 10, 13),
#filename = "InitialFigs/KO_heatmap.png",
filename = "FinalFigs/Figure3.png",
width = 7,
height = 7)
dev.off()
dev.set(dev.next())
dev.set(dev.next())
pheatmap(KO_Resp_HeatDStt,
legend = T,
legend_breaks = c(-2, -1, 0, 1, 2, max(KO_Resp_HeatDStt)),
legend_labels = c("-2","-1","0","1","2","Abund.\n"),
main = "",
border_color = NA,
scale = "none",
angle_col = 315,
fontsize = 8,
annotation_col = ann_cols,
annotation_row = ann_rows,
annotation_colors = ann_colors,
cluster_rows = F,
cluster_cols = F,
gaps_row = c(12, 19, 25, 31, 50),
gaps_col = c(5, 10, 13),
filename = "InitialFigs/KO_heatmap.png",
#filename = "FinalFigs/Figure3.png",
width = 7,
height = 7)
dev.off()
dev.set(dev.next())
dev.set(dev.next())
